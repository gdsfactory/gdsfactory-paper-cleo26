%% opticameet3.sty
%% Style file for Optica meetings and conferences
%% Version 3 for proper copyright statement
%% Based on Optica Publishing Group template guidelines

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{opticameet3}[2023/07/31 Optica Meeting Style v3]

%% Load required packages
\RequirePackage{mathptmx}  % Times Roman font
\RequirePackage{cite}      % Citation handling
\RequirePackage{graphicx}  % Graphics support
\RequirePackage{url}       % URL formatting

%% Page layout for letter paper
\setlength{\topmargin}{-0.5in}
\setlength{\headheight}{0in}
\setlength{\headsep}{0in}
\setlength{\textheight}{9.5in}
\setlength{\textwidth}{6.5in}
\setlength{\oddsidemargin}{0in}
\setlength{\evensidemargin}{0in}
\setlength{\parindent}{0.25in}
\setlength{\parskip}{0pt}

%% Column separation
\setlength{\columnsep}{0.25in}

%% Float parameters
\setlength{\floatsep}{12pt plus 2pt minus 2pt}
\setlength{\textfloatsep}{12pt plus 2pt minus 2pt}
\setlength{\intextsep}{12pt plus 2pt minus 2pt}

%% Title formatting
\renewcommand{\title}[1]{%
  \gdef\@title{#1}%
}

\renewcommand{\maketitle}{%
  \begin{center}%
    {\large\bfseries\@title\par}%
    \vskip 1em%
    {\normalsize\@author\par}%
    \vskip 0.5em%
    {\small\itshape\@address\par}%
    \vskip 0.5em%
    {\small\@email\par}%
  \end{center}%
  \vskip 1em%
}

%% Author and address commands
\newcommand{\@address}{}
\newcommand{\address}[1]{\gdef\@address{#1}}
\newcommand{\@email}{}
\newcommand{\email}[1]{\gdef\@email{#1}}

%% Abstract environment
\renewenvironment{abstract}{%
  \noindent\textbf{Abstract:}\ %
}{%
  \par\vskip 1em%
}

%% Section formatting
\renewcommand{\section}{%
  \@startsection{section}{1}{0pt}%
    {-12pt plus -2pt minus -2pt}%
    {6pt plus 2pt minus 2pt}%
    {\normalfont\normalsize\bfseries}%
}

\renewcommand{\subsection}{%
  \@startsection{subsection}{2}{0pt}%
    {-10pt plus -2pt minus -2pt}%
    {4pt plus 2pt minus 2pt}%
    {\normalfont\normalsize\bfseries}%
}

\renewcommand{\subsubsection}{%
  \@startsection{subsubsection}{3}{0pt}%
    {-8pt plus -2pt minus -2pt}%
    {2pt plus 2pt minus 2pt}%
    {\normalfont\normalsize\itshape}%
}

%% Caption formatting
\long\def\@makecaption#1#2{%
  \vskip\abovecaptionskip
  \sbox\@tempboxa{\small #1. #2}%
  \ifdim \wd\@tempboxa >\hsize
    \small #1. #2\par
  \else
    \global \@minipagefalse
    \hb@xt@\hsize{\hfil\box\@tempboxa\hfil}%
  \fi
  \vskip\belowcaptionskip}

%% Bibliography formatting
\renewcommand{\refname}{References}

%% Compact list environments
\renewenvironment{itemize}{%
  \begin{list}{$\bullet$}{%
    \setlength{\itemsep}{0pt}%
    \setlength{\parsep}{0pt}%
    \setlength{\topsep}{4pt}%
    \setlength{\leftmargin}{1.5em}%
  }%
}{%
  \end{list}%
}

\renewenvironment{enumerate}{%
  \begin{list}{\arabic{enumi}.}{%
    \usecounter{enumi}%
    \setlength{\itemsep}{0pt}%
    \setlength{\parsep}{0pt}%
    \setlength{\topsep}{4pt}%
    \setlength{\leftmargin}{1.5em}%
  }%
}{%
  \end{list}%
}

\endinput
